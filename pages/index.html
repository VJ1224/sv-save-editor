<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Stardew Valley Save Editor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.0-beta2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
    <link rel="stylesheet" href="/static/css/styles.min.css">
</head>

<body>
    <section class="login-clean">
        <form method="post" style="max-width: 50%;min-width: 50%;" onsubmit="readFile(event)">
            <img src="/static/img/logo.png" style="width: 100%;height: 25%;">
            <label class="form-label">Upload Save File:</label>
            <input class="form-control" type="file" id="save-file">
            <button class="btn btn-primary d-block w-100" type="submit" style="color: var(--bs-light);background: var(--bs-red);">Submit</button>
        </form>
    </section>

    <script>
        function readFile(event) {
          event.preventDefault();
          let save = document.getElementById("save-file").files[0];
          let filename = save.name;

          fetch("/filename", {
            method: "POST",
            body: filename
          }).then(response => {
            console.log(response);
          });

          const reader = new FileReader();
          reader.onload = sendFile;
          reader.readAsText(save);
        }

        function sendFile(event) {
          fetch("/upload", {
            method: "POST",
            body: event.target.result
          }).then(response => {
            console.log(response);
            window.location.href = '/profile';
          });
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.0-beta2/js/bootstrap.bundle.min.js"></script>
</body>

</html>